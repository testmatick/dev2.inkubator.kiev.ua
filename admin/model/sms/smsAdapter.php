<?php  define("DIR_SMS_JS", "view/javascript/"); define("DIR_SMS_IMG", "view/image/"); if(defined("HTTP_CATALOG")) { define("DELIVERY_URL", HTTP_CATALOG."index.php?route=sms/delivery"); } define("SMS_WEB_URL", "www.cart-sms.com"); define("SMS_STAT_BACK_COLOR", "#ffffff"); define("SMS_ENABLE_COLOR", true); class SmsAdapterController extends Controller { protected $marketingFilter; static public $colors = array( 0 => "#D47705", 1 => "#4068C4", 2 => "#C438E0", 3 => "#38D8E0", 4 => "#38E043", 5 => "#EFF43A", 6 => "#F79E0E", 7 => "#1802B9", 8 => "#F48CD2", 9 => "#09FF00", ); public static $MarketingTemplateCustomers = array( "firstname" => "firstname", "lastname" => "lastname", "email" => "email", "telephone" => "telephone" ); public static $MarketingTemplateShop = array( "shop_name" => "shop_name", "shop_domain" => "shop_domain", "shop_email" => "shop_email", "shop_phone" => "shop_phone" ); public static $MarketingTemplateCoupons = array( "name" => "coupon_name", "code" => "coupon_code", "type" => "coupon_type", "discount" => "coupon_discount", "total" => "coupon_total", "date_start" => "coupon_date_start", "date_end" => "coupon_date_end", "uses_total" => "coupon_uses_total", "uses_customer" => "coupon_uses_customer" );  protected function index() { $this->load->model('sms/main'); $this->load->model('sms/hooks'); $this->getDefaultLanguageMutation(); require_once($this->model_sms_hooks->getLanguageDirectory()); if(method_exists($this , "createFilter") && defined("SMS_FILTER_ON")) { $this->createFilter(); } $i5071ce49aa74dec77b6a05acd8c726411c9543d8 = new UserProfile($this->getDb()); if(!($i5071ce49aa74dec77b6a05acd8c726411c9543d8->getUsername() && $i5071ce49aa74dec77b6a05acd8c726411c9543d8->getPassword()) && $_GET["route"] != "sms/profile") { $this->displayError(v_smshistory_usernotactive); $this->smsRedirect($this->getLink("sms/profile")); } $this->startup(); $ib1199182837e705aae8d93f525c88b1184f9395d['header'] = $this->load->controller('common/header'); $ib1199182837e705aae8d93f525c88b1184f9395d['column_left'] = $this->load->controller('common/column_left'); $ib1199182837e705aae8d93f525c88b1184f9395d['footer'] = $this->load->controller('common/footer'); $ib1199182837e705aae8d93f525c88b1184f9395d["html"] = $this->display(); $this->response->setOutput($this->load->view('sms/default.tpl', $ib1199182837e705aae8d93f525c88b1184f9395d)); } protected function getLink($ied963540118487a9d2784b2a444521bb641019b9, $ieabf735422ea3c4efba2eadcbb3be1b39c7c0618 = "") { if(is_object($this->url) && method_exists($this->url,"link")) { return $this->url->link($ied963540118487a9d2784b2a444521bb641019b9, 'token=' . $this->session->data['token'] . $ieabf735422ea3c4efba2eadcbb3be1b39c7c0618, 'SSL'); } else { return "index.php?route=".$ied963540118487a9d2784b2a444521bb641019b9.$ieabf735422ea3c4efba2eadcbb3be1b39c7c0618; } }  public function Execute($ife90ec3ee83cd90f9098beed08a011650ddba7e7) { return $this->model_sms_main->Execute($ife90ec3ee83cd90f9098beed08a011650ddba7e7); } public function lastInsertId() { return $this->model_sms_main->lastInsertId(); } public function escape($ibd0578718e12a692b299a588249092e07aac601e) { return $this->model_sms_main->escape($ibd0578718e12a692b299a588249092e07aac601e); } public function getDb() { return $this->model_sms_main->getDb(); }  protected function createFilter() { $this->load->model('sms/main'); $this->marketingFilter = new SmsFilter($this); $this->marketingFilter->addFilter( "select", "type", v_smsmarketing_typ, array( "\$eval = {0}==1;" => "SELECT `customer_id` FROM `".DB_PREFIX."address` WHERE (`company` IS NOT NULL AND `company` NOT LIKE '')", "\$eval = {0}==2;" => "SELECT `customer_id` FROM `".DB_PREFIX."address` WHERE (`company` IS NULL OR `company` = '')" ), array(-1 => v_smsmarketing_allcustomers, 1 => v_smsmarketing_companycustomers, 2 => v_smsmarketing_privatecustomers), "#9acd32" )->addFilter( "select", "country", v_smsmarketing_country, "SELECT `customer_id` FROM `".DB_PREFIX."address` WHERE `country_id`=\"{0}\"", $this->getCountry(), "#005784" )->addFilter( "select", "group", v_smsmarketing_groups, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `customer_group_id`=\"{0}\"", $this->getGroup(), "#d2b48c" )->addFilter( "select", "newsletter", v_smsmarketing_news, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `newsletter`=\"{0}\"", array(-1 => v_smsmarketing_all, 1 => v_smsmarketing_yes, 0 => v_smsmarketing_no), "#cd1818" )->addFilter( "select", "store", v_smsmarketing_store, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `store_id` = \"{0}\"", $this->getStore(), "#8880aa" )->addFilter( "input", "firstname", v_smsmarketing_firstname, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `firstname` LIKE '%{0}%'", null, "#c71585" )->addFilter( "input", "lastname", v_smsmarketing_lastname, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `lastname` LIKE '%{0}%'", null, "#006600" )->addFilter( "input", "postcode", str_replace(":", "", v_adminsmsprofile_zip), "SELECT `customer_id` FROM `".DB_PREFIX."address` WHERE `postcode` = '{0}'", null, "#903689" )->addFilter( "input", "city", v_smsmarketing_city, "SELECT `customer_id` FROM `".DB_PREFIX."address` WHERE city LIKE '%{0}%'", null, "#ff8000" )->addFilter( "datetime", "register", v_smsmarketing_registerfrom, "SELECT `customer_id` FROM `".DB_PREFIX."customer` WHERE `date_added`>=\"{0}\" AND `date_added`<=\"{1}\"", null, "#907523" )->addFilter( "relationValue", "order", v_customersms_order, array( "\$eval = {0}==0;" => "SELECT `".DB_PREFIX."order`.`customer_id`, max(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order`.`customer_id` HAVING `total` < '{1}';", "\$eval = {0}==1;" => "SELECT `".DB_PREFIX."order`.`customer_id`, max(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order`.`customer_id` HAVING `total` > '{1}';", "\$eval = {0}==2;" => "SELECT `".DB_PREFIX."order`.`customer_id`, max(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order`.`customer_id` HAVING `total` = '{1}';", "\$eval = {0}==3;" => "SELECT `".DB_PREFIX."order`.`customer_id`, max(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order`.`customer_id` HAVING `total` != '{1}';" ), array(array(0 => "<", 1 => ">", 2 => "=", 3 => "≠"), null), "#902080" )->addFilter( "relationValue", "sumOrder", "∑ " . v_customersms_order, array( "\$eval = {0}==0;" => "SELECT `".DB_PREFIX."order`.`customer_id`, sum(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order.customer_id` HAVING `total` < '{1}';", "\$eval = {0}==1;" => "SELECT `".DB_PREFIX."order`.`customer_id`, sum(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order.customer_id` HAVING `total` > '{1}';", "\$eval = {0}==2;" => "SELECT `".DB_PREFIX."order`.`customer_id`, sum(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order.customer_id` HAVING `total` = '{1}';", "\$eval = {0}==3;" => "SELECT `".DB_PREFIX."order`.`customer_id`, sum(`".DB_PREFIX."order`.`total`) as `total` FROM `".DB_PREFIX."order` GROUP BY `".DB_PREFIX."order.customer_id` HAVING `total` != '{1}';" ), array(array(0 => "<", 1 => ">", 2 => "=", 3 => "≠"), null), "#886543" )->addFilter( "input", "product", v_adminsms_product, "SELECT `".DB_PREFIX."order`.`customer_id` FROM `".DB_PREFIX."order` INNER JOIN `".DB_PREFIX."order_product` ON `".DB_PREFIX."order_product`.`order_id` = `".DB_PREFIX."order`.`order_id` WHERE `".DB_PREFIX."order_product`.`name` LIKE \"%{0}%\" OR `".DB_PREFIX."order_product`.`model` LIKE \"%{0}%\" GROUP BY `".DB_PREFIX."order`.`customer_id`;", null, "#77aacc" ); } public function getDefaultLanguageMutation() { if(!defined("SMS_DEFAULT_MUTATION")) { $this->load->model('setting/setting'); $ib7c1d4f54a9806a128d06041566a7989c9e5ba1a = $this->model_setting_setting->getSetting("config"); define("SMS_DEFAULT_MUTATION", $ib7c1d4f54a9806a128d06041566a7989c9e5ba1a["config_language"]); } } protected function getLanguageMutation() { $i35d0bf7a77a6df945bffd9eb93f1166d26c8231f = 0; $ib1199182837e705aae8d93f525c88b1184f9395d = array(SMS_DEFAULT_MUTATION => ""); $this->mutationColors[SMS_DEFAULT_MUTATION] = $i35d0bf7a77a6df945bffd9eb93f1166d26c8231f++; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM `".DB_PREFIX."language`"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { if($i2e93e61d67c274d891066238c74ba6322d527b6d["code"] != SMS_DEFAULT_MUTATION) { $this->mutationColors[$i2e93e61d67c274d891066238c74ba6322d527b6d["code"]] = ($i35d0bf7a77a6df945bffd9eb93f1166d26c8231f++) % count(self::$colors); } $ib1199182837e705aae8d93f525c88b1184f9395d[$i2e93e61d67c274d891066238c74ba6322d527b6d["code"]] = $i2e93e61d67c274d891066238c74ba6322d527b6d["name"]; } } return $ib1199182837e705aae8d93f525c88b1184f9395d; } protected function getActualLanguage() { return $this->language->get('code'); } protected function getTemplateRepalce() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = "<script language=\"javascript\"> function getTemplateValues(text) {"; $i02fcabda2448d40bdb76bd10f9e95950039649ee .= $this->getTemplateReplaceCustomers(); $i02fcabda2448d40bdb76bd10f9e95950039649ee .= $this->getTemplateReplaceShop(); $i02fcabda2448d40bdb76bd10f9e95950039649ee .= $this->getTemplateReplaceCoupon(); $i02fcabda2448d40bdb76bd10f9e95950039649ee .= " return text; } </script>"; return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getTemplateReplaceCustomers() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = ""; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT ".implode(array_keys(self::$MarketingTemplateCustomers),", ")." FROM `".DB_PREFIX."customer` ORDER BY customer_id DESC LIMIT 1"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach(self::$MarketingTemplateCustomers as $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 => $i15d84483bc094d6911ad509960fe2e79b90a34e2) { $i02fcabda2448d40bdb76bd10f9e95950039649ee .= 'text=text.replaceAll("{'.$i15d84483bc094d6911ad509960fe2e79b90a34e2.'}","'.htmlspecialchars($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695]).'");'; } } return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getTemplateReplaceShop() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = ""; $ib1199182837e705aae8d93f525c88b1184f9395d = $this->getShopVariables(0); foreach(self::$MarketingTemplateShop as $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 => $i15d84483bc094d6911ad509960fe2e79b90a34e2) { $i02fcabda2448d40bdb76bd10f9e95950039649ee .= 'text=text.replaceAll("{'.$i15d84483bc094d6911ad509960fe2e79b90a34e2.'}","'.htmlspecialchars($ib1199182837e705aae8d93f525c88b1184f9395d[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695]).'");'; } return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getTemplateReplaceCoupon() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = ""; $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d = $this->model_setting_setting->getSetting("config"); $i0a3adc7f4c38171232abf754e0a5bd16e3823141 = $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d["config_currency"]; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT ".implode(array_keys(self::$MarketingTemplateCoupons),", ")." FROM `".DB_PREFIX."coupon` ORDER BY coupon_id DESC LIMIT 1"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach(self::$MarketingTemplateCoupons as $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 => $i15d84483bc094d6911ad509960fe2e79b90a34e2) { if($i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 == "type") { if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695] == "P") { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695] = "%"; } else { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695] = strtoupper($i0a3adc7f4c38171232abf754e0a5bd16e3823141); } } if($i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 == "discount" || $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 == "total") { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695] = number_format($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695], 2); } $i02fcabda2448d40bdb76bd10f9e95950039649ee .= 'text=text.replaceAll("{'.$i15d84483bc094d6911ad509960fe2e79b90a34e2.'}","'.$i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695].'");'; } } return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getCountry() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = array(-1 => v_smsmarketing_allcountries); $ife90ec3ee83cd90f9098beed08a011650ddba7e7 = "SELECT * FROM ".DB_PREFIX."country order by name;"; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute($ife90ec3ee83cd90f9098beed08a011650ddba7e7); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i02fcabda2448d40bdb76bd10f9e95950039649ee[$i2e93e61d67c274d891066238c74ba6322d527b6d['country_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name']; } } return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getGroup() { $i02fcabda2448d40bdb76bd10f9e95950039649ee = array(-1 => v_smsmarketing_all); $i2fa22577ba8b4fc242704deb47ba1bee87cfcf8b = $this->language->get('code'); $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM ".DB_PREFIX."language where code = '".$i2fa22577ba8b4fc242704deb47ba1bee87cfcf8b."'"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["language_id"]; $ife90ec3ee83cd90f9098beed08a011650ddba7e7 = "SELECT * FROM ".DB_PREFIX."customer_group"; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute($ife90ec3ee83cd90f9098beed08a011650ddba7e7); if(!isset($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["name"])) { $ife90ec3ee83cd90f9098beed08a011650ddba7e7 = "SELECT * FROM ".DB_PREFIX."customer_group_description WHERE language_id = $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 ORDER BY name"; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute($ife90ec3ee83cd90f9098beed08a011650ddba7e7); } if ($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach ($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i02fcabda2448d40bdb76bd10f9e95950039649ee[$i2e93e61d67c274d891066238c74ba6322d527b6d['customer_group_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name']; } } } return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getStore($i4634336a1e81bb16090b8274342518824230ea1f = true) { if($i4634336a1e81bb16090b8274342518824230ea1f) { $i02fcabda2448d40bdb76bd10f9e95950039649ee = array(-1 => v_smsmarketing_all); } else { $i02fcabda2448d40bdb76bd10f9e95950039649ee = array(); } $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM ".DB_PREFIX."setting WHERE `key`= 'config_name'"); if(isset($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["store_id"])) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i02fcabda2448d40bdb76bd10f9e95950039649ee[$i2e93e61d67c274d891066238c74ba6322d527b6d["store_id"]] = $i2e93e61d67c274d891066238c74ba6322d527b6d["value"]; } } else { $i02fcabda2448d40bdb76bd10f9e95950039649ee[0] = $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["value"]; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT store_id, name FROM ".DB_PREFIX."store"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i02fcabda2448d40bdb76bd10f9e95950039649ee[$i2e93e61d67c274d891066238c74ba6322d527b6d["store_id"]] = $i2e93e61d67c274d891066238c74ba6322d527b6d["name"]; } } } ksort($i02fcabda2448d40bdb76bd10f9e95950039649ee); return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getMarketingCustomerSQL($i1e07524a5f7d809e59fb1f8e06980c63cb599b8a, $iefa4c7b7e08431daa83b1765e5363ae0d6341701) { return "SELECT ".DB_PREFIX."customer.*, " . "".DB_PREFIX."address.city, " . "".DB_PREFIX."address.country_id " . "FROM ".DB_PREFIX."customer " . "LEFT JOIN ".DB_PREFIX."address ON ".DB_PREFIX."customer.customer_id = ".DB_PREFIX."address.customer_id " . "WHERE telephone NOT LIKE '' ".$i1e07524a5f7d809e59fb1f8e06980c63cb599b8a." ".$iefa4c7b7e08431daa83b1765e5363ae0d6341701." GROUP BY ".DB_PREFIX."customer.customer_id ORDER BY lastname"; } protected function getMarketingDisabledSQL($iee89255f959f4474301355c283c3e9a6c2316167) { return " AND ".DB_PREFIX."customer.customer_id NOT IN (".implode(",", $iee89255f959f4474301355c283c3e9a6c2316167).")"; } protected function getMarketingFilteredSQL($ic4324c4544b80dfa783ca4be081d513146b855f5) { return " AND ".DB_PREFIX."customer.customer_id IN (".implode(",", $ic4324c4544b80dfa783ca4be081d513146b855f5).")"; } protected function getAddressBook($i24559340659e3654ee9c4f36d94523f268e83b49) { return "SELECT ".DB_PREFIX."customer.*, ".DB_PREFIX."address.city,".DB_PREFIX."address.country_id FROM ".DB_PREFIX."customer LEFT JOIN ".DB_PREFIX."address ON ".DB_PREFIX."customer.customer_id = ".DB_PREFIX."address.customer_id WHERE ".DB_PREFIX."customer.lastname like '".$this->escape($i24559340659e3654ee9c4f36d94523f268e83b49)."%' AND ".DB_PREFIX."customer.telephone NOT LIKE '' GROUP BY ".DB_PREFIX."customer.customer_id ORDER BY ".DB_PREFIX."customer.lastname"; } protected function historySQL($ie5b0dc673ae7185f8cfea133baf9fef6a88b3281, $ibf21559a5865d0706b08586780050d04efc951d3, $i088e5493da345fd9a50093a74c3f1d122db69ddd, $i8024d40934acf9d34496d0ce8da8dfdddb144510, $i4e6cbb05864feef2268e92e46254e6ddb9e746be) { return "SELECT ".DB_PREFIX."sp_sms_history.*, ".DB_PREFIX."customer.firstname, ".DB_PREFIX."customer.lastname, ".DB_PREFIX."sp_admins.name adminName FROM ".DB_PREFIX."sp_sms_history LEFT JOIN ".DB_PREFIX."customer ON ".DB_PREFIX."sp_sms_history.customer_ID = ".DB_PREFIX."customer.customer_id LEFT JOIN ".DB_PREFIX."sp_admins ON ".DB_PREFIX."sp_sms_history.admin_ID = ".DB_PREFIX."sp_admins.ID WHERE date like '".$this->escape($ie5b0dc673ae7185f8cfea133baf9fef6a88b3281)."'".$this->escape($ibf21559a5865d0706b08586780050d04efc951d3)."".$this->escape($i088e5493da345fd9a50093a74c3f1d122db69ddd)." order by ID desc limit ".$this->escape($i8024d40934acf9d34496d0ce8da8dfdddb144510).", ".$this->escape($i4e6cbb05864feef2268e92e46254e6ddb9e746be).""; } protected function getShopVariables($i9322503a2838022b31ef0bac9048907b83e1e4eb) { if(!isset($i9322503a2838022b31ef0bac9048907b83e1e4eb)) { $i9322503a2838022b31ef0bac9048907b83e1e4eb = 0; } $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM ".DB_PREFIX."setting where `key` IN ('config_name','config_email','config_telephone')"); if ($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach ($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { if(!isset($i2e93e61d67c274d891066238c74ba6322d527b6d['store_id']) || $i2e93e61d67c274d891066238c74ba6322d527b6d['store_id'] == $i9322503a2838022b31ef0bac9048907b83e1e4eb) { if($i2e93e61d67c274d891066238c74ba6322d527b6d['key']=="config_name") { $ia3d7732f487de160f1fc1748a1e6b27d76a47dd7 = $i2e93e61d67c274d891066238c74ba6322d527b6d['value']; } if($i2e93e61d67c274d891066238c74ba6322d527b6d['key']=="config_email") { $i33e0233602f385884233d2f8ff3040269210e672 = $i2e93e61d67c274d891066238c74ba6322d527b6d['value']; } if($i2e93e61d67c274d891066238c74ba6322d527b6d['key']=="config_telephone") { $i02e60c04de1c70a4810ac5e8440a5be192e7c2ee = $i2e93e61d67c274d891066238c74ba6322d527b6d['value']; } } } } $icae1003a7b78317ecd106d559490d2ed7842f01917d5d79435864186bbd31ed71a5dfa74d68c67d = HTTP_CATALOG; return array("shop_name" => $ia3d7732f487de160f1fc1748a1e6b27d76a47dd7, "shop_domain" => $icae1003a7b78317ecd106d559490d2ed7842f01917d5d79435864186bbd31ed71a5dfa74d68c67d, "shop_email" => $i33e0233602f385884233d2f8ff3040269210e672, "shop_phone" => $i02e60c04de1c70a4810ac5e8440a5be192e7c2ee); } protected function getTimezoneSettings() { $this->load->model('setting/setting'); $ib7c1d4f54a9806a128d06041566a7989c9e5ba1a = $this->model_setting_setting->getSetting("sms"); $this->timezone = $ib7c1d4f54a9806a128d06041566a7989c9e5ba1a["sms_timezone"]; $ie5b0dc673ae7185f8cfea133baf9fef6a88b3281 = new DateTime(null, new DateTimeZone("Europe/Prague")); if(strlen(trim($this->timezone)) == 0) { $this->timezone = date_default_timezone_get(); } date_default_timezone_set($this->timezone); return date("Y-m-d H:i:s", $ie5b0dc673ae7185f8cfea133baf9fef6a88b3281->format('U')); } protected function getCoupons() { $id6df7fb626ea7dcb74a3aeaed55471bda0715fc1 = array(); $this->load->model('setting/setting'); $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d = $this->model_setting_setting->getSetting("config"); $i0a3adc7f4c38171232abf754e0a5bd16e3823141 = $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d["config_currency"]; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM `".DB_PREFIX."coupon` WHERE `status` = '1'"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { if($i2e93e61d67c274d891066238c74ba6322d527b6d["type"] == "P") { $i2e93e61d67c274d891066238c74ba6322d527b6d["type"] = "%"; } else { $i2e93e61d67c274d891066238c74ba6322d527b6d["type"] = strtoupper($i0a3adc7f4c38171232abf754e0a5bd16e3823141); } $id6df7fb626ea7dcb74a3aeaed55471bda0715fc1[$i2e93e61d67c274d891066238c74ba6322d527b6d["coupon_id"]] = $i2e93e61d67c274d891066238c74ba6322d527b6d; } } return $id6df7fb626ea7dcb74a3aeaed55471bda0715fc1; } protected function getCouponSelect($ie8bf65cd40f70005ebeae2be139a406353b7a989) { $ie8bf65cd40f70005ebeae2be139a406353b7a989elect = array(-1 => "- ".v_marketing_none." -"); foreach($ie8bf65cd40f70005ebeae2be139a406353b7a989 as $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 => $i2c0ef3bef9410f3bf64e2871a1e4a7bb4dbc7f69) { $ie8bf65cd40f70005ebeae2be139a406353b7a989elect[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695] = $i2c0ef3bef9410f3bf64e2871a1e4a7bb4dbc7f69["name"]; } return $ie8bf65cd40f70005ebeae2be139a406353b7a989elect; } protected function getStoreForm($i9322503a2838022b31ef0bac9048907b83e1e4eb) { return v_smsmarketing_store." ".SmsController::getSelect(array("name" => "store"), $this->getStore(false), $i9322503a2838022b31ef0bac9048907b83e1e4eb); } protected function getCouponForm($ie8bf65cd40f70005ebeae2be139a406353b7a989, $i638555cbe7ed2af60dac0c7d163508bf34c13283) { $i02fcabda2448d40bdb76bd10f9e95950039649ee = v_marketing_coupon.": ".SmsController::getSelect(array("name" => "coupon", "onchange" => "toggleCouponVariables();", "id" => "couponSelect"), $this->getCouponSelect($ie8bf65cd40f70005ebeae2be139a406353b7a989), $i638555cbe7ed2af60dac0c7d163508bf34c13283). " <a href=".$this->getLink("marketing/coupon/add").">".v_marketing_coupon_create."</a>"; $i02fcabda2448d40bdb76bd10f9e95950039649ee .= "<p id=\"couponVariables\" class=\"hidden\">".$this->getTags(self::$MarketingTemplateCoupons)."</p>"; return $i02fcabda2448d40bdb76bd10f9e95950039649ee; } protected function getCouponData($icae1003a7b78317ecd106d559490d2ed7842f019) { $ib1199182837e705aae8d93f525c88b1184f9395d = array(); $this->load->model('setting/setting'); $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d = $this->model_setting_setting->getSetting("config"); $i0a3adc7f4c38171232abf754e0a5bd16e3823141 = $i807ea0cf599d0dd55639db53c304ec0a2bf8bc5d["config_currency"]; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT ".implode(array_keys(self::$MarketingTemplateCoupons),", ")." FROM `".DB_PREFIX."coupon` WHERE `coupon_id` = '".$this->escape($icae1003a7b78317ecd106d559490d2ed7842f019)."'"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["type"] == "P") { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["type"] = "%"; } else { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["type"] = strtoupper($i0a3adc7f4c38171232abf754e0a5bd16e3823141); } $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["discount"] = number_format($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["discount"], 2); $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["total"] = number_format($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["total"], 2); $ib1199182837e705aae8d93f525c88b1184f9395d = $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row; } return $ib1199182837e705aae8d93f525c88b1184f9395d; }  protected function smsProduct($i0a3adc7f4c38171232abf754e0a5bd16e3823141, $i6815574ea6fb0d16ca760ac76ccd5e787398426b, $ife5dcc4866b634771ff6e888ca85e32e7f4e8fac, $ia3225bb1fa0556b70e4ad48c0617117b5a0606a2) { $i33626cbf744302d3b735ee5624a900755cf0365c = 0; $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "language"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i7477cbf041b8a81dd42a2e06796383cc304d5243[$i2e93e61d67c274d891066238c74ba6322d527b6d["code"]] = $i2e93e61d67c274d891066238c74ba6322d527b6d["language_id"]; } } foreach($i0a3adc7f4c38171232abf754e0a5bd16e3823141 as $i96d461834688e728b7089d6508d252cfa28e9214) { if(isset($ia3225bb1fa0556b70e4ad48c0617117b5a0606a2[$i96d461834688e728b7089d6508d252cfa28e9214])) { $i3da7d27ed65066b98b003daf0808f54e53cda923 = $ia3225bb1fa0556b70e4ad48c0617117b5a0606a2[$i96d461834688e728b7089d6508d252cfa28e9214]; } else { $i3da7d27ed65066b98b003daf0808f54e53cda923 = 0; } $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "product INNER JOIN " . DB_PREFIX . "product_to_store ON " . DB_PREFIX . "product.product_id = " . DB_PREFIX . "product_to_store.product_id WHERE model like 'InfoSMS' AND store_id = " . $this->escape($i6815574ea6fb0d16ca760ac76ccd5e787398426b) . ";"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $i33626cbf744302d3b735ee5624a900755cf0365c = $i2e93e61d67c274d891066238c74ba6322d527b6d["product_id"]; } } if($i33626cbf744302d3b735ee5624a900755cf0365c == 0) { $this->Execute("INSERT INTO `" . DB_PREFIX . "product` (`model`, `location`, `quantity`, `stock_status_id`, `image`, `manufacturer_id`, `shipping`, `price`, `tax_class_id`, `date_available`, `weight`, `weight_class_id`, `length`, `width`, `height`, `length_class_id`, `status`, `date_added`, `date_modified`, `viewed`, `subtract`) VALUES ('InfoSMS', '', 1000, 7, 'data/sms/logocart.png', 0, 0, '" . $this->escape($i3da7d27ed65066b98b003daf0808f54e53cda923) . "', 0, 'CURRENT_DATE()', 0.00000000, 1, 0.00000000, 0.00000000, 0.00000000, 1, 1, 'NOW()', '0000-0-0 00:00:00', 0, 0);"); $i33626cbf744302d3b735ee5624a900755cf0365c = $this->lastInsertId(); $this->Execute("INSERT INTO `" . DB_PREFIX . "product_to_store` (`product_id`, `store_id`) VALUES ('" . $this->escape($i33626cbf744302d3b735ee5624a900755cf0365c) . "', '" . $this->escape($i6815574ea6fb0d16ca760ac76ccd5e787398426b) . "')"); } else { $this->Execute("UPDATE " . DB_PREFIX . "product set price='" . $this->escape($i3da7d27ed65066b98b003daf0808f54e53cda923) . "' where product_id=" . $this->escape($i33626cbf744302d3b735ee5624a900755cf0365c)); } if(is_array($ife5dcc4866b634771ff6e888ca85e32e7f4e8fac)) { foreach($ife5dcc4866b634771ff6e888ca85e32e7f4e8fac as $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 => $ibd0578718e12a692b299a588249092e07aac601e) { $this->Execute("REPLACE INTO `" . DB_PREFIX . "product_description` (`product_id`, `language_id`, `name`, `description`) VALUES ('$i33626cbf744302d3b735ee5624a900755cf0365c', '" . $this->escape($i7477cbf041b8a81dd42a2e06796383cc304d5243[$i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695]) . "', '" . $this->escape($ibd0578718e12a692b299a588249092e07aac601e) . "', '');"); } } $i33626cbf744302d3b735ee5624a900755cf0365c = 0; } } public function getDefaultCurrency() { return "SELECT * FROM " . DB_PREFIX . "setting WHERE `key`= 'config_currency'"; } public function getLanguages() { return "SELECT * FROM " . DB_PREFIX . "language where status = 1"; } public function getLanguageId() { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = 1; $i2fa22577ba8b4fc242704deb47ba1bee87cfcf8b = substr($this->language->get('code'), 0, 2); $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "language where code = '" . $i2fa22577ba8b4fc242704deb47ba1bee87cfcf8b . "'"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["language_id"]; } else { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "language LIMIT 1"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $i83d1339527a9dc91b02fa99420eb13b0cd47adfe->row["language_id"]; } } return $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1; }  public function loadHooksForOrdersAdmin() { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $this->getLanguageId(); if($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 != null) { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "order_status where language_id = '" . $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 . "' order by order_status_id ASC"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $this->res_groups[0][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']][] = "actionOrderStatusPostUpdate"; $this->res_hooks_info["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name'] . " [" . $i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id'] . "]"; $this->res_hooks_template["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = v_smsprestashop_sqltemplate11 . strtolower($i2e93e61d67c274d891066238c74ba6322d527b6d['name']) . v_smsprestashop_sqltemplate111; $this->res_hooks_notice["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = v_smsprestashop_notice . "<br /> {customer_id}, {customer_email}, {customer_company}, {customer_lastname}, {customer_firstname}, {customer_address}, {customer_postcode}, {customer_city}, {customer_country}, {customer_state}, {customer_phone}, {customer_mobile}, {customer_vat_number}, {customer_invoice_company}, {customer_invoice_lastname}, {customer_invoice_firstname}, {customer_invoice_address}, {customer_invoice_postcode}, {customer_invoice_city}, {customer_invoice_country}, {customer_invoice_state}, {customer_invoice_phone}, {customer_invoice_mobile}, {customer_invoice_vat_number}<br /><br />{shop_domain}, {shop_name}, {shop_email}, {shop_phone}<br /><br />{order_id}, {order_payment}, {order_total_paid}, {order_currency}, {order_date}, {order_date1}, {order_date2}, {order_date3}, {order_date4}, {order_date5}, {order_date6}, {order_date7}, {order_time}, {order_time1}<br /><br /> {order_products1}, {order_products2}, {order_products3}, {order_products4}, {order_products5}, {order_products6}, {order_products7}, {order_products8}<br /><br />{employee_id}, {employee_email}, {customer_message}"; $this->res_hooks_background["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = "#0092BA"; $this->res_hooks_icon["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = ""; } } return true; } return false; } public function loadHooksForReturnsAdmin() { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $this->getLanguageId(); if($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 != null) { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "return_status WHERE language_id = " . $this->escape($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1) . " ORDER BY return_status_id ASC"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $this->res_groups[5][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']][] = "actionReturnGoodStatus"; $this->res_hooks_info["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name'] . " [" . $i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id'] . "]"; $this->res_hooks_template["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = v_smsprestashop_return_status_admin . strtolower($i2e93e61d67c274d891066238c74ba6322d527b6d['name']) . v_smsprestashop_return_status_admin2; $this->res_hooks_notice["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = "{customer_address}, {customer_city}, {customer_company}, {customer_country_id}, {customer_country}, {customer_email}, {customer_firstname}, {customer_id}, {customer_invoice_address}, {customer_invoice_city}, {customer_invoice_company}, {customer_invoice_country_id}, {customer_invoice_country}, {customer_invoice_firstname}, {customer_invoice_lastname}, {customer_invoice_mobile}, {customer_invoice_phone}, {customer_invoice_postcode}, {customer_invoice_state}, {customer_lastname}, {customer_message}, {customer_mobile}, {customer_phone}, {customer_postcode}, {customer_state}, {date_ordered}<br /><br />{employee_email}, {employee_id}<br /><br />{order_currency}, {order_date1}, {order_date2}, {order_date3}, {order_date4}, {order_date5}, {order_date6}, {order_date7}, {order_id}, {order_shipping_number}, {order_time1}, {order_time}, {order_total_paid}<br /><br />{product_id}, {product_model}, {product_name}, {product_quantity}<br /><br />{return_action_id}, {return_action}, {return_date}, {return_id}, {return_reason_id}, {return_reason}, {return_status_id}, {return_status}<br /><br /> {shop_email}, {shop_id}, {shop_name}, {shop_phone}"; $this->res_hooks_background["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = "#0092BA"; $this->res_hooks_icon["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = ""; } } return true; } return false; } public function loadHooksForOrdersCustomers() { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $this->getLanguageId(); if($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 != null) { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "order_status WHERE language_id = " . $this->escape($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1) . " ORDER BY order_status_id ASC"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $this->res_groups[0][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']][] = "actionOrderStatusPostUpdate"; $this->res_hooks_info["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name'] . " [" . $i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id'] . "]"; $this->res_hooks_template["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = v_smsprestashop_sqltemplate211 . strtolower($i2e93e61d67c274d891066238c74ba6322d527b6d['name']) . v_smsprestashop_sqltemplate2111; $this->res_hooks_notice["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = v_smsprestashop_notice . "<br />{customer_id}, {customer_email}, {customer_company}, {customer_lastname}, {customer_firstname}, {customer_address}, {customer_postcode}, {customer_city}, {customer_country}, {customer_state}, {customer_phone}, {customer_mobile}, {customer_vat_number}, {customer_invoice_company}, {customer_invoice_lastname}, {customer_invoice_firstname}, {customer_invoice_address}, {customer_invoice_postcode}, {customer_invoice_city}, {customer_invoice_country}, {customer_invoice_state}, {customer_invoice_phone}, {customer_invoice_mobile}, {customer_invoice_vat_number}<br /><br />{shop_domain}, {shop_name}, {shop_email}, {shop_phone}<br /><br />{order_id}, {order_payment}, {order_total_paid}, {order_currency}, {order_date}, {order_date1}, {order_date2}, {order_date3}, {order_date4}, {order_date5}, {order_date6}, {order_date7}, {order_time}, {order_time1}<br /><br /> {order_products1}, {order_products2}, {order_products3}, {order_products4}, {order_products5}, {order_products6}, {order_products7}, {order_products8}<br /><br />{employee_id}, {employee_email}, {customer_message}"; $this->res_hooks_background["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = "#0092BA"; $this->res_hooks_icon["actionOrderStatusPostUpdate"][$i2e93e61d67c274d891066238c74ba6322d527b6d['order_status_id']] = ""; } } return true; } return false; } public function loadHooksForReturnsCustomers() { $ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 = $this->getLanguageId(); if($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1 != null) { $i83d1339527a9dc91b02fa99420eb13b0cd47adfe = $this->Execute("SELECT * FROM " . DB_PREFIX . "return_status WHERE language_id = " . $this->escape($ib0bde0deebcf33e155f4fc320178ec4f2a562ec1) . " ORDER BY return_status_id ASC"); if($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->num_rows) { foreach($i83d1339527a9dc91b02fa99420eb13b0cd47adfe->rows as $i2e93e61d67c274d891066238c74ba6322d527b6d) { $this->res_groups[5][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']][] = "actionReturnGoodStatus"; $this->res_hooks_info["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = $i2e93e61d67c274d891066238c74ba6322d527b6d['name'] . " [" . $i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id'] . "]"; $this->res_hooks_template["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = v_smsprestashop_return_status_customer . strtolower($i2e93e61d67c274d891066238c74ba6322d527b6d['name']) . v_smsprestashop_return_status_customer2; $this->res_hooks_notice["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = v_smsprestashop_notice . "{customer_address}, {customer_city}, {customer_company}, {customer_country_id}, {customer_country}, {customer_email}, {customer_firstname}, {customer_id}, {customer_invoice_address}, {customer_invoice_city}, {customer_invoice_company}, {customer_invoice_country_id}, {customer_invoice_country}, {customer_invoice_firstname}, {customer_invoice_lastname}, {customer_invoice_mobile}, {customer_invoice_phone}, {customer_invoice_postcode}, {customer_invoice_state}, {customer_lastname}, {customer_message}, {customer_mobile}, {customer_phone}, {customer_postcode}, {customer_state}, {date_ordered}<br /><br />{employee_email}, {employee_id}<br /><br />{order_currency}, {order_date1}, {order_date2}, {order_date3}, {order_date4}, {order_date5}, {order_date6}, {order_date7}, {order_id}, {order_shipping_number}, {order_time1}, {order_time}, {order_total_paid}<br /><br />{product_id}, {product_model}, {product_name}, {product_quantity}<br /><br />{return_action_id}, {return_action}, {return_date}, {return_id}, {return_reason_id}, {return_reason}, {return_status_id}, {return_status}<br /><br />{shop_email}, {shop_id}, {shop_name}, {shop_phone}"; $this->res_hooks_background["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = "#0092BA"; $this->res_hooks_icon["actionReturnGoodStatus"][$i2e93e61d67c274d891066238c74ba6322d527b6d['return_status_id']] = ""; } } return true; } return false; } static public function setSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $ibd0578718e12a692b299a588249092e07aac601e) { $_SESSION[$ib216679acbfbe16a2ae5cf8131949eb25bc84bd9] = serialize($ibd0578718e12a692b299a588249092e07aac601e); } static public function getSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $ib1199182837e705aae8d93f525c88b1184f9395d = null) { if(isset($_SESSION[$ib216679acbfbe16a2ae5cf8131949eb25bc84bd9])) { $ib1199182837e705aae8d93f525c88b1184f9395d = unserialize($_SESSION[$ib216679acbfbe16a2ae5cf8131949eb25bc84bd9]); } return $ib1199182837e705aae8d93f525c88b1184f9395d; } static public function unsetSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9) { if(isset($_SESSION[$ib216679acbfbe16a2ae5cf8131949eb25bc84bd9])) { unset($_SESSION[$ib216679acbfbe16a2ae5cf8131949eb25bc84bd9]); } } static public function addToArraySession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $ibd0578718e12a692b299a588249092e07aac601e) { $ib1199182837e705aae8d93f525c88b1184f9395d = self::getSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, array()); $ib1199182837e705aae8d93f525c88b1184f9395d[] = $ibd0578718e12a692b299a588249092e07aac601e; self::setSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $ib1199182837e705aae8d93f525c88b1184f9395d); } static public function incSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $icae1003a7b78317ecd106d559490d2ed7842f0191da2bd0ee4a875f9bee9c480dc1860a07035d14 = 1) { $ib1199182837e705aae8d93f525c88b1184f9395d = self::getSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, array()); $ib1199182837e705aae8d93f525c88b1184f9395d += $icae1003a7b78317ecd106d559490d2ed7842f0191da2bd0ee4a875f9bee9c480dc1860a07035d14; self::setSession($i7c476fcba547f89fec6ba2f04eb292f4e8da78e7, $ib216679acbfbe16a2ae5cf8131949eb25bc84bd9, $ib1199182837e705aae8d93f525c88b1184f9395d); } public function smsLinkAddressBook($i24559340659e3654ee9c4f36d94523f268e83b49 = "A") { return $this->getLink(filter_input(INPUT_GET, "route")) . '&ajaxAction=addressBook&letter='.$i24559340659e3654ee9c4f36d94523f268e83b49; } public function smsLinkRestoreTemplate($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=restoreTemplate&template=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkDeleteTemplate($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=deleteSaveTemplate&template=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkSaveTemplate() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=saveTemplate"; } public function smsLinkSavedTemplate() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=loadTemplate"; } public function smsLinkHistoryReload() { return str_replace("&amp;", "&", $this->getLink("sms/history")).'&ajaxAction=reload'; } public function smsLinkAnswersReload() { return str_replace("&amp;", "&", $this->getLink("sms/answers")).'&ajaxAction=reload'; } public function smsLinkCustomerSMSMutation() { return $this->getLink(filter_input(INPUT_GET, "route")); } public function smsLinkCustomerSMSMutationSelect($ib3030c2f45bbc82e69ffc17cfc27fca86f99bf23) { return $this->getLink(filter_input(INPUT_GET, "route"), '&submitEditMutation=1&submit=submitEditMutation&mutation=' . $ib3030c2f45bbc82e69ffc17cfc27fca86f99bf23); } public function smsLinkRestoreMarketingTemplate($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=restoreTemplate&template=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkDeleteMarketingTemplate($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=deleteSaveTemplate&template=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkSaveMarketingTemplate() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=saveTemplate"; } public function smsLinkSavedMarketingTemplate() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=loadTemplate"; } public function smsLinkMarketingMore($i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695) { return $this->getLink(filter_input(INPUT_GET, "route")) . '&ajaxAction=showCustomers&letter=' . strtolower($i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695); } public function smsLinkCustomer($id975d9bc81e0d0a6132e7621d64157654ce72c36) { return $this->getLink('sale/customer/edit', "&customer_id=".$id975d9bc81e0d0a6132e7621d64157654ce72c36); } public function smsLinkRemoveCustomerList($id975d9bc81e0d0a6132e7621d64157654ce72c36, $i85fa722e25e7c65af36400add6b4583233eeac75, $i5579973ebfc822255bc7d7a0cd5f73bb8470c829) { return $this->getLink(filter_input(INPUT_GET, "route")). '&ajaxAction=deleteCustomer&customer='.htmlspecialchars($id975d9bc81e0d0a6132e7621d64157654ce72c36) . '&firstname=' . htmlspecialchars($i85fa722e25e7c65af36400add6b4583233eeac75) . '&lastname=' . htmlspecialchars($i5579973ebfc822255bc7d7a0cd5f73bb8470c829); } public function smsLinkAddFilter() { return $this->getLink(filter_input(INPUT_GET, "route")); } public function smsLinkClearFilter() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=clearFilter"; } public function smsLinkSaveFilter() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=saveFilter"; } public function smsLinkRestoreFilter($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route"))."&ajaxAction=restoreFilter&filter=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkDeleteFilter($icae1003a7b78317ecd106d559490d2ed7842f019) { return $this->getLink(filter_input(INPUT_GET, "route"))."&ajaxAction=deleteSaveFilter&filter=".$icae1003a7b78317ecd106d559490d2ed7842f019; } public function smsLinkLoadFilter() { return $this->getLink(filter_input(INPUT_GET, "route")) . "&ajaxAction=loadFilter"; } public function smsLinkTimezone() { return $this->getLink("module/cartsms"); } public function smsLinkPageSave($iff4d7a22830d73b83e55a907cf2b7c446e53db32) { return $this->getLink(filter_input(INPUT_GET, "route")) . base64_decode("JmZpbHRlcj0=") .$iff4d7a22830d73b83e55a907cf2b7c446e53db32; } static public function smsLinkUnsetFilter($i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695, $i961e095ea4df09a257c12c77fceda183f6a1ccd6) { return filter_input(INPUT_SERVER, "REQUEST_URI"). '&ajaxAction=deleteFilter&idFilter=' . $i8a31cdb91ad25bea0cf23b0dd384a4bd00af6695 . '&indexFilter=' . $i961e095ea4df09a257c12c77fceda183f6a1ccd6; } } class dbConnectorResult { public $num_rows = 0; public $rows = array(); public $row = array(); } 